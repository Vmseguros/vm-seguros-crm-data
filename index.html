<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VM SEGUROS - CRM</title>
    <meta name="description" content="Sistema de Gest√£o CRM - VM Seguros">
    <meta name="author" content="VM Seguros">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'vm-blue': '#1e3a8a',
                        'vm-blue-dark': '#1e2a5a',
                        'vm-gray': '#374151',
                        'vm-gray-light': '#4b5563'
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom Styles -->
    <style>
        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #1f2937; border-radius: 2px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 2px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #4b5563 #1f2937; }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hover-scale:hover { transform: scale(1.05); transition: transform 0.2s ease; }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .modal-backdrop {
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="bg-gray-900 font-sans">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-vm-blue-dark to-gray-900">
        <div class="bg-gray-800 p-8 rounded-xl shadow-2xl w-full max-w-md border border-gray-700 fade-in">
            <div class="text-center mb-8">
                <div class="bg-gradient-to-r from-blue-600 to-purple-600 w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-shield-alt text-white text-3xl"></i>
                </div>
                <h1 class="text-3xl font-bold text-white mb-2">VM SEGUROS</h1>
                <p class="text-gray-400">Sistema de Gest√£o CRM</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Usu√°rio</label>
                    <input type="text" id="username" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition duration-200" placeholder="Digite seu usu√°rio" required>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Senha</label>
                    <input type="password" id="password" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition duration-200" placeholder="Digite sua senha" required>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-medium py-3 px-4 rounded-lg transition duration-200 transform hover:scale-105">
                    <i class="fas fa-sign-in-alt mr-2"></i>Entrar
                </button>
            </form>
            
            <!-- Demo Credentials -->
            <div class="mt-6 p-4 bg-gray-700 rounded-lg max-h-48 overflow-y-auto scrollbar-thin">
                <h3 class="text-white font-medium mb-3">üë• Credenciais de Acesso:</h3>
                <div class="text-xs text-gray-300 space-y-2">
                    <div class="bg-red-900 bg-opacity-30 p-2 rounded border border-red-600">
                        <p class="text-red-300 font-bold">üîë ADMIN:</p>
                        <p><strong>Login:</strong> admin</p>
                        <p><strong>Senha:</strong> admin123</p>
                    </div>
                    
                    <div class="bg-blue-900 bg-opacity-30 p-2 rounded border border-blue-600">
                        <p class="text-blue-300 font-bold">üë®‚Äçüíº VENDEDORES:</p>
                        <div class="grid grid-cols-1 gap-1 mt-1">
                            <p><strong>Igor Vicente:</strong> igor.vicente / Realmadridfc12@</p>
                            <p><strong>Rodrigo Mariano:</strong> rodrigo / ninjinha10</p>
                            <p><strong>Jessica Regis:</strong> jessica.regis / jessica123</p>
                            <p><strong>Jaqueline Brito:</strong> jaqueline.brito / jaque123</p>
                            <p><strong>Jessica Brito:</strong> jessica.brito / jbrito123</p>
                            <p><strong>Luana Vieira:</strong> luana.vieira / luana123</p>
                            <p><strong>Leonardo Ferreira:</strong> leonardo.ferreira / leo123</p>
                            <p><strong>Ana Beatriz:</strong> ana.beatriz / ana123</p>
                            <p><strong>Elen Jaconis:</strong> elen.jaconis / elen123</p>
                            <p><strong>Usuario 1:</strong> usuario1 / user123</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main CRM System -->
    <div id="crmSystem" class="hidden">
        <!-- Header -->
        <header class="bg-gray-800 border-b border-gray-700 px-6 py-4 sticky top-0 z-40">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-gradient-to-r from-blue-600 to-purple-600 w-10 h-10 rounded-lg flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white">VM SEGUROS</h1>
                        <span class="text-xs text-gray-400">Sistema CRM</span>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <span class="text-gray-300 hidden md:block">Bem-vindo, <span id="currentUser" class="font-medium text-white">Admin</span></span>
                    <button onclick="forceSyncOnline()" class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg transition duration-200" title="Sincronizar com GitHub">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </button>
                    <button onclick="forceSync()" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg transition duration-200" title="Sincronizar dados locais">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button onclick="logout()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition duration-200">
                        <i class="fas fa-sign-out-alt mr-2"></i>Sair
                    </button>
                </div>
            </div>
        </header>

        <!-- Mobile Menu Toggle -->
        <div class="md:hidden bg-gray-800 px-6 py-2">
            <button onclick="toggleMobileMenu()" class="text-white">
                <i class="fas fa-bars"></i> Menu
            </button>
        </div>

        <!-- Main Layout -->
        <div class="flex">
            <!-- Sidebar -->
            <aside id="sidebar" class="w-64 bg-gray-800 min-h-screen border-r border-gray-700 fixed md:relative z-30 transform -translate-x-full md:translate-x-0 transition-transform duration-300">
                <nav class="p-4">
                    <ul class="space-y-2">
                        <li>
                            <button onclick="showSection('dashboard')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-tachometer-alt mr-3"></i>Dashboard
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('kanban-vendas')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-columns mr-3"></i>Kanban Vendas
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('kanban-indicacoes')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-columns mr-3"></i>Kanban Indica√ß√µes
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('indicacoes')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-handshake mr-3"></i>Indica√ß√µes
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('vendas')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-chart-line mr-3"></i>Vendas
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('vendedores')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-users mr-3"></i>Vendedores
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('comissao')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-percentage mr-3"></i>Comiss√£o
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('cancelamentos')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-times-circle mr-3"></i>Cancelamentos
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('relatorios')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-file-alt mr-3"></i>Relat√≥rios
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('links-uteis')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-link mr-3"></i>Links √öteis
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('sem-sucesso')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-3"></i>Sem Sucesso
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('lead-suhai')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-star mr-3"></i>Lead Suhai
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('configuracoes')" class="nav-item w-full text-left px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-cog mr-3"></i>Configura√ß√µes
                            </button>
                        </li>
                    </ul>
                </nav>
            </aside>

            <!-- Mobile Overlay -->
            <div id="mobileOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden" onclick="toggleMobileMenu()"></div>

            <!-- Main Content -->
            <main class="flex-1 p-4 md:p-6 bg-gray-900 min-h-screen">
                <!-- Dashboard Section -->
                <div id="dashboard" class="section">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Dashboard</h2>
                        <p class="text-gray-400">Vis√£o geral do seu neg√≥cio</p>
                    </div>

                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8">
                        <div class="bg-gray-800 p-4 md:p-6 rounded-xl border border-gray-700 hover-scale">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Leads do Dia</p>
                                    <p class="text-xl md:text-2xl font-bold text-white" id="leadsDoDia">0</p>
                                </div>
                                <div class="bg-blue-600 p-3 rounded-lg">
                                    <i class="fas fa-user-plus text-white text-xl"></i>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800 p-4 md:p-6 rounded-xl border border-gray-700 hover-scale">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Vendas do Dia</p>
                                    <p class="text-xl md:text-2xl font-bold text-white" id="vendasDoDia">0</p>
                                </div>
                                <div class="bg-green-600 p-3 rounded-lg">
                                    <i class="fas fa-chart-line text-white text-xl"></i>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800 p-4 md:p-6 rounded-xl border border-gray-700 hover-scale">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Pr√™mio L√≠quido do Dia</p>
                                    <p class="text-lg md:text-2xl font-bold text-white" id="premioLiquidoDia">R$ 0,00</p>
                                </div>
                                <div class="bg-yellow-600 p-3 rounded-lg">
                                    <i class="fas fa-dollar-sign text-white text-xl"></i>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800 p-4 md:p-6 rounded-xl border border-gray-700 hover-scale">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Pr√™mio L√≠quido do M√™s</p>
                                    <p class="text-lg md:text-2xl font-bold text-white" id="premioLiquidoMes">R$ 0,00</p>
                                </div>
                                <div class="bg-purple-600 p-3 rounded-lg">
                                    <i class="fas fa-trophy text-white text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Kanban Vendas Section -->
                <div id="kanban-vendas" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Kanban Vendas</h2>
                        <p class="text-gray-400">Acompanhe o processo de vendas</p>
                    </div>

                    <div class="mb-4">
                        <button onclick="showNovaVendaModal()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 flex items-center">
                            <i class="fas fa-plus mr-2"></i>Nova Venda
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
                        <!-- Fazer Vistoria -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
                                Fazer Vistoria
                            </h3>
                            <div id="fazerVistoriaContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Vendas ser√£o inseridas aqui -->
                            </div>
                        </div>

                        <!-- Mandar Boletos -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                Mandar Boletos
                            </h3>
                            <div id="mandarBoletosContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Vendas ser√£o inseridas aqui -->
                            </div>
                        </div>

                        <!-- Falta Pagamento -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-orange-500 rounded-full mr-2"></div>
                                Falta Pagamento
                            </h3>
                            <div id="faltaPagamentoContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Vendas ser√£o inseridas aqui -->
                            </div>
                        </div>

                        <!-- Pagamento Efetuado -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                Pagamento Efetuado
                            </h3>
                            <div id="pagamentoEfetuadoContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Vendas ser√£o inseridas aqui -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Kanban Indica√ß√µes Section -->
                <div id="kanban-indicacoes" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Kanban Indica√ß√µes</h2>
                        <p class="text-gray-400">Acompanhe o processo de indica√ß√µes</p>
                    </div>

                    <div class="mb-4">
                        <button onclick="showNovaIndicacaoModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200 flex items-center">
                            <i class="fas fa-plus mr-2"></i>Nova Indica√ß√£o
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
                        <!-- Lead Novo -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                Lead Novo
                            </h3>
                            <div id="leadNovoContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Indica√ß√µes ser√£o inseridas aqui -->
                            </div>
                        </div>

                        <!-- WhatsApp -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                WhatsApp
                            </h3>
                            <div id="whatsappContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Indica√ß√µes ser√£o inseridas aqui -->
                            </div>
                        </div>

                        <!-- Negociando -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
                                Negociando
                            </h3>
                            <div id="negociandoContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Indica√ß√µes ser√£o inseridas aqui -->
                            </div>
                        </div>

                        <!-- Pedindo Dados -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-4">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
                                Pedindo Dados
                            </h3>
                            <div id="pedindoDadosContainer" class="space-y-2 min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-thin">
                                <!-- Indica√ß√µes ser√£o inseridas aqui -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Indica√ß√µes Section -->
                <div id="indicacoes" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Indica√ß√µes</h2>
                        <p class="text-gray-400">Gerencie suas indica√ß√µes de clientes</p>
                    </div>

                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white">Lista de Indica√ß√µes</h3>
                            <button onclick="showNovaIndicacaoModal()" class="bg-vm-blue hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-plus mr-2"></i>Nova Indica√ß√£o
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Nome</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Telefone</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Ve√≠culo</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Vendedor</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Status</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="indicacoesTableBody" class="divide-y divide-gray-700">
                                    <!-- Indica√ß√µes ser√£o inseridas aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Vendas Section -->
                <div id="vendas" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Vendas</h2>
                        <p class="text-gray-400">Gerencie suas vendas realizadas</p>
                    </div>

                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white">Lista de Vendas</h3>
                            <button onclick="showNovaVendaModal()" class="bg-vm-blue hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-plus mr-2"></i>Nova Venda
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Cliente</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Produto</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Empresa</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Vendedor</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Pr√™mio L√≠quido</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">% Comiss√£o</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Comiss√£o Total</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Comiss√£o Vendedor</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="vendasTableBody" class="divide-y divide-gray-700">
                                    <!-- Vendas ser√£o inseridas aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Vendedores Section -->
                <div id="vendedores" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Vendedores</h2>
                        <p class="text-gray-400">Gerencie sua equipe de vendas</p>
                    </div>

                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white">Lista de Vendedores</h3>
                            <button onclick="showNovoVendedorModal()" class="bg-vm-blue hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition duration-200 flex items-center">
                                <i class="fas fa-plus mr-2"></i>Novo Vendedor
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Nome</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Login</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Meta Mensal</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">% Comiss√£o</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Status</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="vendedoresTableBody" class="divide-y divide-gray-700">
                                    <!-- Vendedores ser√£o inseridos aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Comiss√£o Section -->
                <div id="comissao" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Comiss√£o</h2>
                        <p class="text-gray-400">Controle de comiss√µes dos vendedores</p>
                    </div>

                    <!-- Lista Detalhada de Comiss√µes -->
                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6 mb-6">
                        <h3 class="text-xl font-bold text-white mb-6">Lista Detalhada de Comiss√µes</h3>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Cliente</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Vendedor</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Produto</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Empresa</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Pr√™mio L√≠quido</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Comiss√£o</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Data</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="comissaoDetalhadaTableBody" class="divide-y divide-gray-700">
                                    <!-- Comiss√µes detalhadas ser√£o inseridas aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Resumo Total -->
                    <div class="bg-gradient-to-r from-gray-800 to-gray-700 rounded-xl border border-gray-600 p-6 shadow-lg">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="text-center">
                                <div class="bg-blue-600 p-3 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                                    <i class="fas fa-chart-line text-white text-2xl"></i>
                                </div>
                                <h4 class="text-lg font-bold text-white mb-2">Total de Vendas</h4>
                                <p class="text-3xl font-bold text-blue-400" id="totalVendasComissao">0</p>
                            </div>
                            
                            <div class="text-center">
                                <div class="bg-green-600 p-3 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                                    <i class="fas fa-dollar-sign text-white text-2xl"></i>
                                </div>
                                <h4 class="text-lg font-bold text-white mb-2">Comiss√£o Total</h4>
                                <p class="text-3xl font-bold text-green-400" id="totalComissaoGeral">R$ 0,00</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cancelamentos Section -->
                <div id="cancelamentos" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Cancelamentos</h2>
                        <p class="text-gray-400">Controle de vendas canceladas</p>
                    </div>

                    <!-- Formul√°rio de Cancelamento -->
                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6 mb-6">
                        <h3 class="text-xl font-bold text-white mb-6">Registrar Cancelamento</h3>
                        
                        <form id="cancelamentoForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Nome Completo</label>
                                <input type="text" id="cancelamentoNome" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-red-500" required>
                            </div>
                            
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Empresa</label>
                                <select id="cancelamentoEmpresa" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-red-500" required>
                                    <option value="">Selecione uma empresa</option>
                                    <option value="Porto Seguro">Porto Seguro</option>
                                    <option value="Bradesco">Bradesco</option>
                                    <option value="Azul Seguros">Azul Seguros</option>
                                    <option value="Suhai">Suhai</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Valor de Estorno (R$)</label>
                                <input type="number" step="0.01" id="cancelamentoValor" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-red-500" required>
                            </div>
                            
                            <div class="md:col-span-3">
                                <button type="submit" class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg transition duration-200 flex items-center">
                                    <i class="fas fa-plus mr-2"></i>Registrar Cancelamento
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                        <h3 class="text-xl font-bold text-white mb-6">Lista de Cancelamentos</h3>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Cliente</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Produto</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Vendedor</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Motivo</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Data</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Valor</th>
                                    </tr>
                                </thead>
                                <tbody id="cancelamentosTableBody" class="divide-y divide-gray-700">
                                    <!-- Cancelamentos ser√£o inseridos aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Relat√≥rios Section -->
                <div id="relatorios" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Relat√≥rios</h2>
                        <p class="text-gray-400">Relat√≥rios e an√°lises do sistema</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-6 hover-scale cursor-pointer">
                            <div class="text-center">
                                <div class="bg-blue-600 p-4 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                                    <i class="fas fa-chart-bar text-white text-2xl"></i>
                                </div>
                                <h3 class="text-lg font-bold text-white mb-2">Vendas por Per√≠odo</h3>
                                <p class="text-gray-400 text-sm">Relat√≥rio detalhado de vendas</p>
                            </div>
                        </div>

                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-6 hover-scale cursor-pointer">
                            <div class="text-center">
                                <div class="bg-green-600 p-4 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                                    <i class="fas fa-users text-white text-2xl"></i>
                                </div>
                                <h3 class="text-lg font-bold text-white mb-2">Performance Vendedores</h3>
                                <p class="text-gray-400 text-sm">An√°lise de desempenho</p>
                            </div>
                        </div>

                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-6 hover-scale cursor-pointer">
                            <div class="text-center">
                                <div class="bg-purple-600 p-4 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                                    <i class="fas fa-percentage text-white text-2xl"></i>
                                </div>
                                <h3 class="text-lg font-bold text-white mb-2">Comiss√µes</h3>
                                <p class="text-gray-400 text-sm">Relat√≥rio de comiss√µes</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Links √öteis Section -->
                <div id="links-uteis" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Links √öteis</h2>
                        <p class="text-gray-400">Links importantes para o trabalho</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                            <h3 class="text-lg font-bold text-white mb-4">Seguradoras</h3>
                            <div class="space-y-2">
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Porto Seguro
                                </a>
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Bradesco Seguros
                                </a>
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Azul Seguros
                                </a>
                            </div>
                        </div>

                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                            <h3 class="text-lg font-bold text-white mb-4">Ferramentas</h3>
                            <div class="space-y-2">
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Calculadora FIPE
                                </a>
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Consulta CPF
                                </a>
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Simulador Seguro
                                </a>
                            </div>
                        </div>

                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                            <h3 class="text-lg font-bold text-white mb-4">Suporte</h3>
                            <div class="space-y-2">
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Manual do Sistema
                                </a>
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>Suporte T√©cnico
                                </a>
                                <a href="#" class="block text-blue-400 hover:text-blue-300 transition duration-200">
                                    <i class="fas fa-external-link-alt mr-2"></i>FAQ
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sem Sucesso Section -->
                <div id="sem-sucesso" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Sem Sucesso</h2>
                        <p class="text-gray-400">Leads que n√£o resultaram em vendas</p>
                    </div>

                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                        <h3 class="text-xl font-bold text-white mb-6">Lista de Leads Sem Sucesso</h3>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Nome</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Telefone</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Vendedor</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Motivo</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Data</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="semSucessoTableBody" class="divide-y divide-gray-700">
                                    <!-- Leads sem sucesso ser√£o inseridos aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Lead Suhai Section -->
                <div id="lead-suhai" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Lead Suhai</h2>
                        <p class="text-gray-400">Vendas enviadas para processamento Suhai</p>
                    </div>
                    
                    <div class="bg-gray-800 rounded-xl border border-gray-700 p-6 mb-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white">Lista de Leads Suhai</h3>
                            <div class="bg-yellow-600 text-white px-3 py-1 rounded-full text-sm font-medium">
                                <i class="fas fa-star mr-1"></i>Processamento Suhai
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Cliente</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Vendedor</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Produto</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Empresa</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Pr√™mio L√≠quido</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Comiss√£o</th>
                                        <th class="px-6 py-4 text-left text-gray-300 font-medium">Data Envio</th>
                                    </tr>
                                </thead>
                                <tbody id="leadSuhaiTableBody" class="divide-y divide-gray-700">
                                    <!-- Leads Suhai ser√£o inseridos aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Estat√≠sticas Elegantes Lead Suhai -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Estat√≠sticas Gerais -->
                        <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Total de Vendas -->
                            <div class="bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 rounded-2xl p-6 border border-blue-600 shadow-2xl transform hover:scale-105 transition-all duration-300">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="bg-blue-500 bg-opacity-30 p-3 rounded-full">
                                        <i class="fas fa-chart-line text-blue-300 text-2xl"></i>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-blue-200 text-sm font-medium">Total de Vendas</div>
                                        <div class="text-3xl font-bold text-white" id="totalVendasSuhai">0</div>
                                    </div>
                                </div>
                                <div class="bg-blue-800 bg-opacity-50 rounded-lg p-2">
                                    <div class="text-blue-200 text-xs">Leads processados Suhai</div>
                                </div>
                            </div>

                            <!-- Total de Comiss√£o -->
                            <div class="bg-gradient-to-br from-emerald-900 via-emerald-800 to-emerald-700 rounded-2xl p-6 border border-emerald-600 shadow-2xl transform hover:scale-105 transition-all duration-300">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="bg-emerald-500 bg-opacity-30 p-3 rounded-full">
                                        <i class="fas fa-dollar-sign text-emerald-300 text-2xl"></i>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-emerald-200 text-sm font-medium">Comiss√£o Total</div>
                                        <div class="text-3xl font-bold text-white" id="totalComissaoSuhai">R$ 0,00</div>
                                    </div>
                                </div>
                                <div class="bg-emerald-800 bg-opacity-50 rounded-lg p-2">
                                    <div class="text-emerald-200 text-xs">Valor total em comiss√µes</div>
                                </div>
                            </div>
                        </div>

                        <!-- Ranking Top 3 Vendedores -->
                        <div class="bg-gradient-to-br from-purple-900 via-purple-800 to-purple-700 rounded-2xl p-6 border border-purple-600 shadow-2xl">
                            <div class="flex items-center mb-6">
                                <div class="bg-purple-500 bg-opacity-30 p-2 rounded-full mr-3">
                                    <i class="fas fa-trophy text-purple-300 text-lg"></i>
                                </div>
                                <h4 class="text-lg font-bold text-white">Top 3 Vendedores</h4>
                            </div>
                            
                            <div id="rankingVendedoresSuhai" class="space-y-3">
                                <!-- Ranking ser√° inserido aqui -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Configura√ß√µes Section -->
                <div id="configuracoes" class="section hidden">
                    <div class="mb-6">
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-2">Configura√ß√µes</h2>
                        <p class="text-gray-400">Gerencie configura√ß√µes do sistema</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Adicionar Usu√°rio -->
                        <div class="bg-gray-800 rounded-xl border border-gray-700 p-6">
                            <h3 class="text-xl font-bold text-white mb-6">Adicionar Usu√°rio</h3>
                            
                            <form id="usuarioForm" class="space-y-4">
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Nome Completo</label>
                                    <input type="text" id="usuarioNome" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Login</label>
                                    <input type="text" id="usuarioLogin" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Senha</label>
                                    <input type="password" id="usuarioSenha" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Tipo</label>
                                    <select id="usuarioTipo" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                                        <option value="vendedor">Vendedor</option>
                                        <option value="admin">Admin</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Comiss√£o (%)</label>
                                    <input type="number" id="usuarioComissao" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Meta (R$)</label>
                                    <input type="number" id="usuarioMeta" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                                </div>
                                
                                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg transition duration-200">
                                    <i class="fas fa-plus mr-2"></i>Adicionar Usu√°rio
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <!-- Nova Indica√ß√£o Modal -->
    <div id="novaIndicacaoModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 hidden flex items-center justify-center">
        <div class="bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4 border border-gray-700">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-white">Nova Indica√ß√£o</h3>
                <button onclick="closeModal('novaIndicacaoModal')" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="indicacaoForm" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Nome do Cliente</label>
                        <input type="text" id="indicacaoNome" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Telefone</label>
                        <input type="tel" id="indicacaoTelefone" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Ve√≠culo</label>
                        <input type="text" id="indicacaoVeiculo" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Vendedor</label>
                        <select id="indicacaoVendedor" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                            <option value="">Selecione um vendedor</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Observa√ß√µes</label>
                    <textarea id="indicacaoObservacoes" rows="3" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" placeholder="Observa√ß√µes sobre o cliente ou negocia√ß√£o..."></textarea>
                </div>
                
                <div class="flex space-x-4">
                    <button type="button" onclick="closeModal('novaIndicacaoModal')" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg transition duration-200">
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg transition duration-200">
                        <i class="fas fa-plus mr-2"></i>Adicionar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Nova Venda Modal -->
    <div id="novaVendaModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 hidden flex items-center justify-center">
        <div class="bg-gray-800 rounded-xl p-6 w-full max-w-2xl mx-4 border border-gray-700 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-white">Nova Venda</h3>
                <button onclick="closeModal('novaVendaModal')" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="vendaForm" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Nome Completo</label>
                        <input type="text" id="vendaCliente" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Produto</label>
                        <select id="vendaProduto" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                            <option value="">Selecione um produto</option>
                            <option value="Seguro Auto">Seguro Auto</option>
                            <option value="Seguro Residencial">Seguro Residencial</option>
                            <option value="Seguro Vida">Seguro Vida</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Empresa</label>
                        <select id="vendaEmpresa" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                            <option value="">Selecione uma empresa</option>
                            <option value="Porto Seguro">Porto Seguro</option>
                            <option value="Bradesco">Bradesco</option>
                            <option value="Azul Seguros">Azul Seguros</option>
                            <option value="Suhai">Suhai</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Vendedor</label>
                        <select id="vendaVendedor" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required onchange="calcularComissoes()">
                            <option value="">Selecione um vendedor</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Pr√™mio L√≠quido (R$)</label>
                        <input type="number" step="0.01" id="vendaPremio" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required oninput="calcularComissoes()">
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">% de Comiss√£o da Venda</label>
                        <input type="number" step="0.01" id="vendaPercentualComissao" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required oninput="calcularComissoes()">
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Comiss√£o Total (R$)</label>
                        <input type="number" step="0.01" id="vendaComissaoTotal" class="w-full px-4 py-3 bg-gray-600 border border-gray-500 rounded-lg text-gray-300" readonly>
                    </div>
                    
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Comiss√£o Vendedor (R$)</label>
                        <input type="number" step="0.01" id="vendaComissaoVendedor" class="w-full px-4 py-3 bg-gray-600 border border-gray-500 rounded-lg text-gray-300" readonly>
                    </div>
                </div>
                
                <div class="flex space-x-4 mt-6">
                    <button type="button" onclick="closeModal('novaVendaModal')" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg transition duration-200">
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg transition duration-200">
                        <i class="fas fa-plus mr-2"></i>Adicionar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Novo Vendedor Modal -->
    <div id="novoVendedorModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 hidden flex items-center justify-center">
        <div class="bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4 border border-gray-700">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-white">Novo Vendedor</h3>
                <button onclick="closeModal('novoVendedorModal')" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="novoVendedorForm" class="space-y-4">
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Nome Completo</label>
                    <input type="text" id="vendedorNome" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Usu√°rio para Vincular</label>
                    <select id="vendedorUsuario" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                        <option value="">Selecione um usu√°rio</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Meta Mensal (R$)</label>
                    <input type="number" step="0.01" id="vendedorMeta" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">% de Comiss√£o</label>
                    <input type="number" step="0.01" id="vendedorComissao" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                </div>
                
                <div class="flex space-x-4">
                    <button type="button" onclick="closeModal('novoVendedorModal')" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg transition duration-200">
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg transition duration-200">
                        <i class="fas fa-plus mr-2"></i>Adicionar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Editar Vendedor Modal -->
    <div id="editarVendedorModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 hidden flex items-center justify-center">
        <div class="bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4 border border-gray-700">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-white">Editar Vendedor</h3>
                <button onclick="closeModal('editarVendedorModal')" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editarVendedorForm" class="space-y-4">
                <input type="hidden" id="editVendedorId">
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Nome Completo</label>
                    <input type="text" id="editVendedorNome" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Usu√°rio Vinculado</label>
                    <select id="editVendedorUsuario" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                        <option value="">Selecione um usu√°rio</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">Meta Mensal (R$)</label>
                    <input type="number" step="0.01" id="editVendedorMeta" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-gray-300 text-sm font-medium mb-2">% de Comiss√£o</label>
                    <input type="number" step="0.01" id="editVendedorComissao" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" required>
                </div>
                
                <div class="flex space-x-4">
                    <button type="button" onclick="closeModal('editarVendedorModal')" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg transition duration-200">
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg transition duration-200">
                        <i class="fas fa-save mr-2"></i>Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o -->
    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 hidden flex items-center justify-center">
        <div class="bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4 border border-gray-700 shadow-2xl">
            <div class="text-center mb-6">
                <div class="bg-red-600 p-3 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-white text-2xl"></i>
                </div>
                <h3 id="confirmTitle" class="text-xl font-bold text-white mb-2"></h3>
                <p id="confirmMessage" class="text-gray-300 text-sm whitespace-pre-line"></p>
            </div>
            
            <div class="flex space-x-4">
                <button onclick="closeConfirmModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg transition duration-200 font-medium">
                    <i class="fas fa-times mr-2"></i>Cancelar
                </button>
                <button id="confirmButton" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg transition duration-200 font-medium">
                    <i class="fas fa-check mr-2"></i>Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Sistema b√°sico para demonstra√ß√£o
        let currentUser = null;
        let onlineSystem = null;
        let leadsSemSucesso = [];
        let leadsSubai = [];
        let indicacoes = [
            { id: 1, nome: 'Carlos Oliveira', telefone: '(11) 99999-9999', veiculo: 'Honda Civic 2020', vendedor: 'Rodrigo Mariano', status: 'Lead Novo', data: new Date().toLocaleDateString('pt-BR') },
            { id: 2, nome: 'Fernanda Lima', telefone: '(11) 88888-8888', veiculo: 'Toyota Corolla 2019', vendedor: 'Jessica Regis', status: 'WhatsApp', data: new Date().toLocaleDateString('pt-BR') },
            { id: 3, nome: 'Roberto Silva', telefone: '(11) 77777-7777', veiculo: 'Volkswagen Jetta 2021', vendedor: 'Ana Beatriz', status: 'Negociando', data: new Date().toLocaleDateString('pt-BR') },
            { id: 4, nome: 'Luciana Santos', telefone: '(11) 66666-6666', veiculo: 'Nissan Sentra 2020', vendedor: 'Luana Vieira', status: 'Pedindo Dados', data: new Date().toLocaleDateString('pt-BR') }
        ];
        let vendas = [
            { id: 1, cliente: 'Jo√£o Silva', produto: 'Seguro Auto', empresa: 'Porto Seguro', vendedor: 'Rodrigo Mariano', premioLiquido: 2500.00, percentualComissao: 30, comissaoTotal: 750.00, comissaoVendedor: 225.00, status: 'Fazer Vistoria', data: new Date().toLocaleDateString('pt-BR') },
            { id: 2, cliente: 'Maria Santos', produto: 'Seguro Residencial', empresa: 'Bradesco', vendedor: 'Jessica Regis', premioLiquido: 1800.00, percentualComissao: 25, comissaoTotal: 450.00, comissaoVendedor: 112.50, status: 'Mandar Boletos', data: new Date().toLocaleDateString('pt-BR') }
        ];
        let comissoesPagas = [];
        let cancelamentos = [];
        let linksUteis = [];
        let empresas = ['Porto Seguro', 'Bradesco', 'Azul Seguros', 'Suhai'];
        let produtos = ['Seguro Auto', 'Seguro Residencial', 'Seguro Vida'];
        
        // Sistema de Sincroniza√ß√£o Online Real com GitHub
        let syncInterval = null;
        let lastUpdateTime = Date.now();
        let githubConfig = {
            owner: 'seu-usuario-github', // Substitua pelo seu usu√°rio do GitHub
            repo: 'vm-seguros-data', // Nome do reposit√≥rio para dados
            branch: 'main',
            token: null, // Token ser√° configurado dinamicamente
            apiUrl: 'https://api.github.com'
        };
        
        // Dados de demonstra√ß√£o
        const usuarios = [
            { id: 1, nome: 'Admin', login: 'admin', senha: 'admin123', tipo: 'admin', comissao: 0, fixoGarantido: 0, meta: 0 },
            { id: 2, nome: 'Igor Vicente', login: 'igor.vicente', senha: 'Realmadridfc12@', tipo: 'vendedor', comissao: 30, fixoGarantido: 2000, meta: 50000 },
            { id: 3, nome: 'Rodrigo Mariano', login: 'rodrigo', senha: 'ninjinha10', tipo: 'vendedor', comissao: 30, fixoGarantido: 2000, meta: 50000 },
            { id: 4, nome: 'Jessica Regis', login: 'jessica.regis', senha: 'jessica123', tipo: 'vendedor', comissao: 25, fixoGarantido: 1500, meta: 40000 },
            { id: 5, nome: 'Jaqueline Brito', login: 'jaqueline.brito', senha: 'jaque123', tipo: 'vendedor', comissao: 27, fixoGarantido: 1700, meta: 43000 },
            { id: 6, nome: 'Jessica Brito', login: 'jessica.brito', senha: 'jbrito123', tipo: 'vendedor', comissao: 26, fixoGarantido: 1600, meta: 42000 },
            { id: 7, nome: 'Luana Vieira', login: 'luana.vieira', senha: 'luana123', tipo: 'vendedor', comissao: 26, fixoGarantido: 1600, meta: 42000 },
            { id: 8, nome: 'Leonardo Ferreira', login: 'leonardo.ferreira', senha: 'leo123', tipo: 'vendedor', comissao: 29, fixoGarantido: 1900, meta: 47000 },
            { id: 9, nome: 'Ana Beatriz', login: 'ana.beatriz', senha: 'ana123', tipo: 'vendedor', comissao: 28, fixoGarantido: 1800, meta: 45000 },
            { id: 10, nome: 'Elen Jaconis', login: 'elen.jaconis', senha: 'elen123', tipo: 'vendedor', comissao: 27, fixoGarantido: 1700, meta: 44000 },
            { id: 11, nome: 'Usuario 1', login: 'usuario1', senha: 'user123', tipo: 'vendedor', comissao: 25, fixoGarantido: 1500, meta: 40000 }
        ];
        
        let vendasSemSucesso = [];
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Login form handler
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                // Find user
                const user = usuarios.find(u => u.login === username && u.senha === password);
                
                if (user) {
                    currentUser = user;
                    document.getElementById('currentUser').textContent = user.nome;
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('crmSystem').classList.remove('hidden');
                    
                    // Initialize system
                    onlineSystem = new OnlineSystem();
                    initializeSystem();
                    
                    // Show success message
                    setTimeout(() => {
                        onlineSystem.showNotification(`Bem-vindo, ${user.nome}!`, 'success');
                    }, 500);
                } else {
                    alert('Usu√°rio ou senha incorretos!');
                }
            });

            // Initialize modal forms
            initializeModalForms();
            
            // Initialize online sync with GitHub (fallback to local)
            initializeOnlineSync();
        });
        
        // Sistema de Sincroniza√ß√£o Online com GitHub
        function initializeOnlineSync() {
            // Carregar configura√ß√£o GitHub salva
            loadGitHubConfig();
            
            // Carregar dados do GitHub primeiro, depois localStorage como fallback
            loadDataFromGitHub().then(() => {
                console.log('Dados carregados do GitHub com sucesso');
                if (onlineSystem) {
                    onlineSystem.updateConnectionStatus('online');
                }
            }).catch(() => {
                console.log('Carregando dados do localStorage como fallback');
                loadDataFromStorage();
                if (onlineSystem) {
                    onlineSystem.updateConnectionStatus('offline');
                }
            });
            
            // Configurar salvamento autom√°tico online
            setupOnlineAutoSave();
            
            // Configurar sincroniza√ß√£o entre abas
            setupCrossTabSync();
            
            // Configurar sincroniza√ß√£o peri√≥dica com GitHub
            setupGitHubSync();
        }
        
        function loadGitHubConfig() {
            try {
                const savedConfig = localStorage.getItem('vm_github_config');
                if (savedConfig) {
                    const config = JSON.parse(savedConfig);
                    githubConfig.owner = config.owner || githubConfig.owner;
                    githubConfig.repo = config.repo || githubConfig.repo;
                    githubConfig.branch = config.branch || githubConfig.branch;
                }
            } catch (error) {
                console.log('Erro ao carregar configura√ß√£o GitHub:', error);
            }
        }
        
        // Sistema de Armazenamento Local para Sincroniza√ß√£o (Fallback)
        function initializeLocalStorageSync() {
            // Carregar dados do localStorage se existirem
            loadDataFromStorage();
            
            // Configurar salvamento autom√°tico
            setupAutoSave();
            
            // Configurar sincroniza√ß√£o entre abas
            setupCrossTabSync();
        }
        
        function loadDataFromStorage() {
            try {
                const storedIndicacoes = localStorage.getItem('vm_indicacoes');
                const storedVendas = localStorage.getItem('vm_vendas');
                const storedLeadsSemSucesso = localStorage.getItem('vm_leadsSemSucesso');
                const storedLeadsSubai = localStorage.getItem('vm_leadsSubai');
                const storedCancelamentos = localStorage.getItem('vm_cancelamentos');
                
                if (storedIndicacoes) {
                    indicacoes.length = 0;
                    indicacoes.push(...JSON.parse(storedIndicacoes));
                }
                
                if (storedVendas) {
                    vendas.length = 0;
                    vendas.push(...JSON.parse(storedVendas));
                }
                
                if (storedLeadsSemSucesso) {
                    leadsSemSucesso.length = 0;
                    leadsSemSucesso.push(...JSON.parse(storedLeadsSemSucesso));
                }
                
                if (storedLeadsSubai) {
                    leadsSubai.length = 0;
                    leadsSubai.push(...JSON.parse(storedLeadsSubai));
                }
                
                if (storedCancelamentos) {
                    cancelamentos.length = 0;
                    cancelamentos.push(...JSON.parse(storedCancelamentos));
                }
            } catch (error) {
                console.log('Erro ao carregar dados do storage:', error);
            }
        }
        
        function saveDataToStorage() {
            try {
                localStorage.setItem('vm_indicacoes', JSON.stringify(indicacoes));
                localStorage.setItem('vm_vendas', JSON.stringify(vendas));
                localStorage.setItem('vm_leadsSemSucesso', JSON.stringify(leadsSemSucesso));
                localStorage.setItem('vm_leadsSubai', JSON.stringify(leadsSubai));
                localStorage.setItem('vm_cancelamentos', JSON.stringify(cancelamentos));
                localStorage.setItem('vm_lastUpdate', Date.now().toString());
            } catch (error) {
                console.log('Erro ao salvar dados no storage:', error);
            }
        }
        
        // Fun√ß√µes de Sincroniza√ß√£o com GitHub
        async function loadDataFromGitHub() {
            try {
                const response = await fetch(`${githubConfig.apiUrl}/repos/${githubConfig.owner}/${githubConfig.repo}/contents/data.json?ref=${githubConfig.branch}`, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'User-Agent': 'VM-Seguros-CRM'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const content = JSON.parse(atob(data.content));
                    
                    // Carregar dados do GitHub
                    if (content.indicacoes) {
                        indicacoes.length = 0;
                        indicacoes.push(...content.indicacoes);
                    }
                    if (content.vendas) {
                        vendas.length = 0;
                        vendas.push(...content.vendas);
                    }
                    if (content.leadsSemSucesso) {
                        leadsSemSucesso.length = 0;
                        leadsSemSucesso.push(...content.leadsSemSucesso);
                    }
                    if (content.leadsSubai) {
                        leadsSubai.length = 0;
                        leadsSubai.push(...content.leadsSubai);
                    }
                    if (content.cancelamentos) {
                        cancelamentos.length = 0;
                        cancelamentos.push(...content.cancelamentos);
                    }
                    
                    // Salvar tamb√©m no localStorage como backup
                    saveDataToStorage();
                    
                    return true;
                }
            } catch (error) {
                console.log('Erro ao carregar do GitHub:', error);
                throw error;
            }
        }
        
        async function saveDataToGitHub() {
            try {
                const dataToSave = {
                    indicacoes,
                    vendas,
                    leadsSemSucesso,
                    leadsSubai,
                    cancelamentos,
                    lastUpdate: new Date().toISOString(),
                    version: Date.now()
                };
                
                // Primeiro, tentar obter o arquivo atual para pegar o SHA
                let sha = null;
                try {
                    const currentFile = await fetch(`${githubConfig.apiUrl}/repos/${githubConfig.owner}/${githubConfig.repo}/contents/data.json?ref=${githubConfig.branch}`, {
                        headers: {
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'VM-Seguros-CRM'
                        }
                    });
                    
                    if (currentFile.ok) {
                        const currentData = await currentFile.json();
                        sha = currentData.sha;
                    }
                } catch (e) {
                    console.log('Arquivo n√£o existe ainda, ser√° criado');
                }
                
                // Criar ou atualizar o arquivo
                const updateData = {
                    message: `Atualiza√ß√£o autom√°tica CRM - ${new Date().toLocaleString('pt-BR')}`,
                    content: btoa(JSON.stringify(dataToSave, null, 2)),
                    branch: githubConfig.branch
                };
                
                if (sha) {
                    updateData.sha = sha;
                }
                
                const response = await fetch(`${githubConfig.apiUrl}/repos/${githubConfig.owner}/${githubConfig.repo}/contents/data.json`, {
                    method: 'PUT',
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json',
                        'User-Agent': 'VM-Seguros-CRM'
                    },
                    body: JSON.stringify(updateData)
                });
                
                if (response.ok) {
                    console.log('Dados salvos no GitHub com sucesso');
                    return true;
                } else {
                    console.log('Erro ao salvar no GitHub:', response.status);
                    return false;
                }
            } catch (error) {
                console.log('Erro ao salvar no GitHub:', error);
                return false;
            }
        }
        
        function setupOnlineAutoSave() {
            // Salvar dados automaticamente online e localmente
            setInterval(async () => {
                // Sempre salvar localmente
                saveDataToStorage();
                
                // Tentar salvar online (sem bloquear se falhar)
                try {
                    await saveDataToGitHub();
                } catch (error) {
                    console.log('Salvamento online falhou, dados mantidos localmente');
                }
            }, 5000); // Salvar a cada 5 segundos
        }
        
        function setupGitHubSync() {
            // Sincroniza√ß√£o peri√≥dica com GitHub
            setInterval(async () => {
                try {
                    await loadDataFromGitHub();
                    if (onlineSystem && currentUser) {
                        onlineSystem.updateAllInterfaces();
                        onlineSystem.showSyncNotification('Sincronizado com servidor', 'success');
                    }
                } catch (error) {
                    console.log('Sincroniza√ß√£o com GitHub falhou');
                }
            }, 10000); // Sincronizar a cada 10 segundos
        }
        
        function setupAutoSave() {
            // Salvar dados automaticamente a cada mudan√ßa (fallback local)
            setInterval(() => {
                saveDataToStorage();
            }, 2000); // Salvar a cada 2 segundos
        }
        
        function setupCrossTabSync() {
            // Sincronizar entre abas/janelas abertas
            window.addEventListener('storage', function(e) {
                if (e.key && e.key.startsWith('vm_') && e.key !== 'vm_lastUpdate') {
                    // Recarregar dados quando outra aba fizer altera√ß√µes
                    loadDataFromStorage();
                    
                    // Atualizar interface se o sistema estiver inicializado
                    if (onlineSystem && currentUser) {
                        onlineSystem.updateAllInterfaces();
                        onlineSystem.showSyncNotification('Dados sincronizados entre abas', 'success');
                    }
                }
            });
        }
        
        // Sistema Online Simulado com Sincroniza√ß√£o em Tempo Real
        class OnlineSystem {
            constructor() {
                this.isOnline = true;
                this.syncFrequency = 1000; // Sincroniza√ß√£o a cada 1 segundo
                this.lastSync = Date.now();
                this.init();
            }
            
            init() {
                this.showConnectionStatus();
                this.startRealTimeSync();
                this.initLeadSuhaiCheckboxes();
                this.initDataChangeTracking();
            }
            
            showConnectionStatus() {
                const header = document.querySelector('header .flex');
                const statusDiv = document.createElement('div');
                statusDiv.id = 'connectionStatus';
                statusDiv.className = 'flex items-center space-x-1 bg-green-600 px-2 py-1 rounded text-xs cursor-pointer';
                statusDiv.title = 'Clique para configurar sincroniza√ß√£o GitHub';
                statusDiv.innerHTML = `
                    <div class="w-1.5 h-1.5 bg-white rounded-full animate-pulse"></div>
                    <span class="text-white font-medium">Online</span>
                `;
                
                // Adicionar evento de clique para configura√ß√£o
                statusDiv.addEventListener('click', () => {
                    this.showGitHubConfigModal();
                });
                
                header.insertBefore(statusDiv, header.lastElementChild);
            }
            
            showGitHubConfigModal() {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center';
                modal.innerHTML = `
                    <div class="bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4 border border-gray-700">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white">üîß Configura√ß√£o GitHub</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Usu√°rio GitHub</label>
                                <input type="text" id="githubOwner" value="${githubConfig.owner}" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" placeholder="seu-usuario-github">
                            </div>
                            
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Nome do Reposit√≥rio</label>
                                <input type="text" id="githubRepo" value="${githubConfig.repo}" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500" placeholder="vm-seguros-data">
                            </div>
                            
                            <div class="bg-blue-900 bg-opacity-30 p-3 rounded border border-blue-600">
                                <p class="text-blue-300 text-sm">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <strong>Como configurar:</strong><br>
                                    1. Crie um reposit√≥rio p√∫blico no GitHub<br>
                                    2. Insira seu usu√°rio e nome do reposit√≥rio<br>
                                    3. O sistema salvar√° automaticamente os dados
                                </p>
                            </div>
                            
                            <div class="flex space-x-4">
                                <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg transition duration-200">
                                    Cancelar
                                </button>
                                <button onclick="onlineSystem.saveGitHubConfig(); this.closest('.fixed').remove()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg transition duration-200">
                                    <i class="fas fa-save mr-2"></i>Salvar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            }
            
            saveGitHubConfig() {
                const owner = document.getElementById('githubOwner').value.trim();
                const repo = document.getElementById('githubRepo').value.trim();
                
                if (owner && repo) {
                    githubConfig.owner = owner;
                    githubConfig.repo = repo;
                    
                    // Salvar configura√ß√£o no localStorage
                    localStorage.setItem('vm_github_config', JSON.stringify(githubConfig));
                    
                    this.showNotification('Configura√ß√£o GitHub salva! Sincroniza√ß√£o ativada.', 'success');
                    
                    // Tentar sincronizar imediatamente
                    this.testGitHubConnection();
                } else {
                    this.showNotification('Preencha todos os campos!', 'warning');
                }
            }
            
            async testGitHubConnection() {
                try {
                    await saveDataToGitHub();
                    this.updateConnectionStatus('online');
                    this.showNotification('Conex√£o GitHub estabelecida!', 'success');
                } catch (error) {
                    this.updateConnectionStatus('offline');
                    this.showNotification('Erro na conex√£o GitHub. Usando modo local.', 'warning');
                }
            }
            
            updateConnectionStatus(status) {
                const statusElement = document.getElementById('connectionStatus');
                if (statusElement) {
                    if (status === 'online') {
                        statusElement.className = 'flex items-center space-x-1 bg-green-600 px-2 py-1 rounded text-xs cursor-pointer';
                        statusElement.innerHTML = `
                            <div class="w-1.5 h-1.5 bg-white rounded-full animate-pulse"></div>
                            <span class="text-white font-medium">Online</span>
                        `;
                    } else {
                        statusElement.className = 'flex items-center space-x-1 bg-yellow-600 px-2 py-1 rounded text-xs cursor-pointer';
                        statusElement.innerHTML = `
                            <div class="w-1.5 h-1.5 bg-white rounded-full"></div>
                            <span class="text-white font-medium">Local</span>
                        `;
                    }
                }
            }
            
            startRealTimeSync() {
                // Sincroniza√ß√£o ultra-r√°pida para atualiza√ß√µes em tempo real
                syncInterval = setInterval(() => {
                    this.performRealTimeSync();
                }, this.syncFrequency);
                
                // Sincroniza√ß√£o adicional quando h√° mudan√ßas de dados
                this.setupDataWatchers();
            }
            
            performRealTimeSync() {
                if (this.isOnline && currentUser) {
                    // Atualizar todas as interfaces
                    this.updateAllInterfaces();
                    
                    // Simular sincroniza√ß√£o com servidor
                    this.simulateServerSync();
                    
                    // Atualizar timestamp da √∫ltima sincroniza√ß√£o
                    this.lastSync = Date.now();
                    lastUpdateTime = Date.now();
                }
            }
            
            updateAllInterfaces() {
                // Atualizar todas as tabelas e kanban boards
                updateKanbanIndicacoes();
                updateKanbanVendas();
                updateIndicacoesTable();
                updateVendasTable();
                updateVendedoresTable();
                updateLeadSuhaiTable();
                updateComissaoTable();
                updateComissaoDetalhadaTable();
                updateCancelamentosTable();
                updateSemSucessoTable();
                updateDashboardStats();
                updateLeadSuhaiStats();
            }
            
            simulateServerSync() {
                // Simular comunica√ß√£o com servidor para sincroniza√ß√£o
                const statusElement = document.getElementById('connectionStatus');
                if (statusElement) {
                    // Piscar indicador de sincroniza√ß√£o
                    statusElement.classList.add('animate-pulse');
                    setTimeout(() => {
                        statusElement.classList.remove('animate-pulse');
                    }, 200);
                }
            }
            
            setupDataWatchers() {
                // Observar mudan√ßas nos arrays de dados
                this.watchDataChanges();
            }
            
            watchDataChanges() {
                // Criar proxies para detectar mudan√ßas nos dados
                const originalPush = Array.prototype.push;
                const originalSplice = Array.prototype.splice;
                const self = this;
                
                // Interceptar mudan√ßas nos arrays principais
                [indicacoes, vendas, leadsSemSucesso, leadsSubai, cancelamentos].forEach(array => {
                    if (array && typeof array === 'object') {
                        // Sobrescrever m√©todos que modificam arrays
                        array.push = function(...items) {
                            const result = originalPush.apply(this, items);
                            self.triggerInstantSync();
                            return result;
                        };
                        
                        array.splice = function(...args) {
                            const result = originalSplice.apply(this, args);
                            self.triggerInstantSync();
                            return result;
                        };
                    }
                });
            }
            
            triggerInstantSync() {
                // Sincroniza√ß√£o instant√¢nea quando h√° mudan√ßas
                setTimeout(() => {
                    this.updateAllInterfaces();
                    this.broadcastUpdate();
                }, 50); // Delay m√≠nimo para evitar m√∫ltiplas atualiza√ß√µes
            }
            
            broadcastUpdate() {
                // Simular broadcast para outros usu√°rios conectados
                if (currentUser && currentUser.tipo === 'admin') {
                    // Admin fez uma altera√ß√£o, notificar outros usu√°rios
                    this.showSyncNotification('Dados atualizados em tempo real', 'success');
                }
            }
            
            initDataChangeTracking() {
                // Rastrear mudan√ßas espec√≠ficas para diferentes tipos de usu√°rio
                this.trackUserSpecificChanges();
            }
            
            trackUserSpecificChanges() {
                // Se for vendedor, focar apenas nos seus dados
                if (currentUser && currentUser.tipo === 'vendedor') {
                    this.filterVendorData();
                }
            }
            
            filterVendorData() {
                // Filtrar dados espec√≠ficos do vendedor logado
                const vendorName = currentUser.nome;
                
                // Atualizar apenas dados relevantes para o vendedor
                setInterval(() => {
                    if (currentUser && currentUser.tipo === 'vendedor') {
                        this.updateVendorSpecificData(vendorName);
                    }
                }, 500); // Atualiza√ß√£o ainda mais r√°pida para vendedores
            }
            
            updateVendorSpecificData(vendorName) {
                // Atualizar dados espec√≠ficos do vendedor
                const vendorIndicacoes = indicacoes.filter(i => i.vendedor === vendorName);
                const vendorVendas = vendas.filter(v => v.vendedor === vendorName);
                
                // Atualizar interfaces com dados filtrados
                this.updateVendorInterfaces(vendorIndicacoes, vendorVendas);
            }
            
            updateVendorInterfaces(vendorIndicacoes, vendorVendas) {
                // Atualizar apenas as se√ß√µes relevantes para o vendedor
                updateKanbanIndicacoes();
                updateKanbanVendas();
                updateDashboardStats();
            }
            
            syncData() {
                this.performRealTimeSync();
            }
            
            showSyncNotification(message, type = 'info') {
                // Notifica√ß√£o discreta de sincroniza√ß√£o
                const notification = document.createElement('div');
                notification.className = `fixed bottom-4 right-4 z-40 p-2 rounded-lg shadow-lg transition-all duration-300 transform translate-y-full`;
                
                const bgColor = type === 'success' ? 'bg-green-600' : 'bg-blue-600';
                notification.className += ` ${bgColor} text-white text-xs`;
                
                notification.innerHTML = `
                    <div class="flex items-center space-x-1">
                        <i class="fas fa-sync-alt text-xs"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.classList.remove('translate-y-full');
                }, 100);
                
                setTimeout(() => {
                    notification.classList.add('translate-y-full');
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 2000);
            }
            
            initLeadSuhaiCheckboxes() {
                // Adicionar event listeners para checkboxes Lead Suhai
                document.addEventListener('change', function(e) {
                    if (e.target.classList.contains('lead-suhai-checkbox')) {
                        const data = {
                            cliente: e.target.dataset.cliente,
                            vendedor: e.target.dataset.vendedor,
                            comissao: e.target.dataset.comissao,
                            produto: e.target.dataset.produto,
                            empresa: e.target.dataset.empresa,
                            premioLiquido: e.target.dataset.premioLiquido,
                            dataEnvio: new Date().toLocaleDateString('pt-BR')
                        };
                        
                        // Verificar se j√° existe (evitar duplicatas)
                        const jaExiste = leadsSubai.some(lead => 
                            lead.cliente === data.cliente && 
                            lead.vendedor === data.vendedor && 
                            lead.produto === data.produto
                        );
                        
                        if (e.target.checked && !jaExiste) {
                            leadsSubai.push(data);
                            updateLeadSuhaiTable();
                            onlineSystem.showNotification(`${data.cliente} enviado para Lead Suhai!`, 'success');
                        } else if (!e.target.checked) {
                            // Remover do Lead Suhai
                            leadsSubai = leadsSubai.filter(lead => 
                                !(lead.cliente === data.cliente && 
                                  lead.vendedor === data.vendedor && 
                                  lead.produto === data.produto)
                            );
                            updateLeadSuhaiTable();
                            onlineSystem.showNotification(`${data.cliente} removido do Lead Suhai!`, 'warning');
                        } else if (jaExiste) {
                            onlineSystem.showNotification(`${data.cliente} j√° est√° no Lead Suhai!`, 'warning');
                            e.target.checked = true; // Manter marcado
                        }
                    }
                });
                
                // Event listeners para formul√°rios
                this.initFormListeners();
            }
            
            initFormListeners() {
                // Formul√°rio de usu√°rio
                document.getElementById('usuarioForm').addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const novoUsuario = {
                        id: Date.now(),
                        nome: document.getElementById('usuarioNome').value,
                        login: document.getElementById('usuarioLogin').value,
                        senha: document.getElementById('usuarioSenha').value,
                        tipo: document.getElementById('usuarioTipo').value,
                        comissao: parseFloat(document.getElementById('usuarioComissao').value),
                        meta: parseFloat(document.getElementById('usuarioMeta').value)
                    };
                    
                    usuarios.push(novoUsuario);
                    updateVendedoresTable();
                    this.reset();
                    onlineSystem.showNotification('Usu√°rio adicionado!', 'success');
                });
                
                // Formul√°rio de cancelamento
                document.getElementById('cancelamentoForm').addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const novoCancelamento = {
                        id: Date.now(),
                        nome: document.getElementById('cancelamentoNome').value,
                        empresa: document.getElementById('cancelamentoEmpresa').value,
                        valorEstorno: parseFloat(document.getElementById('cancelamentoValor').value),
                        data: new Date().toLocaleDateString('pt-BR')
                    };
                    
                    cancelamentos.push(novoCancelamento);
                    updateCancelamentosTable();
                    this.reset();
                    onlineSystem.showNotification('Cancelamento registrado!', 'success');
                });
            }
            
            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 transform translate-x-full`;
                
                const bgColor = type === 'success' ? 'bg-green-600' : type === 'warning' ? 'bg-yellow-600' : 'bg-blue-600';
                notification.className += ` ${bgColor} text-white`;
                
                notification.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-${type === 'success' ? 'check' : type === 'warning' ? 'exclamation-triangle' : 'info'}-circle"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);
                
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }
            
            forceSync() {
                this.syncData();
                this.showNotification('Dados sincronizados!', 'success');
            }
        }

        // Calculate commissions automatically
        function calcularComissoes() {
            const premioLiquido = parseFloat(document.getElementById('vendaPremio').value) || 0;
            const percentualComissao = parseFloat(document.getElementById('vendaPercentualComissao').value) || 0;
            const vendedorNome = document.getElementById('vendaVendedor').value;
            
            // Calculate total commission
            const comissaoTotal = (premioLiquido * percentualComissao) / 100;
            document.getElementById('vendaComissaoTotal').value = comissaoTotal.toFixed(2);
            
            // Calculate vendor commission
            if (vendedorNome) {
                const vendedor = usuarios.find(u => u.nome === vendedorNome);
                if (vendedor) {
                    const comissaoVendedor = (comissaoTotal * vendedor.comissao) / 100;
                    document.getElementById('vendaComissaoVendedor').value = comissaoVendedor.toFixed(2);
                }
            }
        }

        // Initialize modal forms
        function initializeModalForms() {
            // Indica√ß√£o form
            document.getElementById('indicacaoForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const editingId = this.dataset.editingId;
                
                if (editingId) {
                    // Editando indica√ß√£o existente
                    const indicacaoIndex = indicacoes.findIndex(i => i.id == editingId);
                    if (indicacaoIndex !== -1) {
                        indicacoes[indicacaoIndex] = {
                            ...indicacoes[indicacaoIndex],
                            nome: document.getElementById('indicacaoNome').value,
                            telefone: document.getElementById('indicacaoTelefone').value,
                            veiculo: document.getElementById('indicacaoVeiculo').value,
                            vendedor: document.getElementById('indicacaoVendedor').value,
                            observacoes: document.getElementById('indicacaoObservacoes').value
                        };
                        onlineSystem.showNotification('Indica√ß√£o atualizada!', 'success');
                    }
                    delete this.dataset.editingId;
                } else {
                    // Nova indica√ß√£o
                    const novaIndicacao = {
                        id: Date.now(),
                        nome: document.getElementById('indicacaoNome').value,
                        telefone: document.getElementById('indicacaoTelefone').value,
                        veiculo: document.getElementById('indicacaoVeiculo').value,
                        vendedor: document.getElementById('indicacaoVendedor').value,
                        observacoes: document.getElementById('indicacaoObservacoes').value,
                        status: 'Lead Novo',
                        data: new Date().toLocaleDateString('pt-BR')
                    };
                    
                    indicacoes.push(novaIndicacao);
                    
                    // Salvar imediatamente local e online
                    saveDataToStorage();
                    saveDataToGitHub().then(() => {
                        if (onlineSystem) {
                            onlineSystem.updateConnectionStatus('online');
                        }
                    }).catch(() => {
                        console.log('Salvamento online falhou para indica√ß√£o');
                    });
                    
                    // Notifica√ß√£o especial para admin
                    if (currentUser.tipo === 'admin') {
                        onlineSystem.showNotification(`‚úÖ Indica√ß√£o "${novaIndicacao.nome}" atribu√≠da ao vendedor "${novaIndicacao.vendedor}"`, 'success');
                        onlineSystem.showSyncNotification('Sincronizando online...', 'success');
                    } else {
                        onlineSystem.showNotification('Indica√ß√£o adicionada!', 'success');
                    }
                }
                
                updateKanbanIndicacoes();
                updateIndicacoesTable();
                updateDashboardStats();
                
                this.reset();
                closeModal('novaIndicacaoModal');
            });

            // Venda form
            document.getElementById('vendaForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const vendedor = usuarios.find(u => u.nome === document.getElementById('vendaVendedor').value);
                const premioLiquido = parseFloat(document.getElementById('vendaPremio').value);
                const percentualComissao = parseFloat(document.getElementById('vendaPercentualComissao').value);
                const comissaoTotal = parseFloat(document.getElementById('vendaComissaoTotal').value);
                const comissaoVendedor = parseFloat(document.getElementById('vendaComissaoVendedor').value);
                
                const editingId = this.dataset.editingId;
                
                if (editingId) {
                    // Editando venda existente
                    const vendaIndex = vendas.findIndex(v => v.id == editingId);
                    if (vendaIndex !== -1) {
                        vendas[vendaIndex] = {
                            ...vendas[vendaIndex],
                            cliente: document.getElementById('vendaCliente').value,
                            produto: document.getElementById('vendaProduto').value,
                            empresa: document.getElementById('vendaEmpresa').value,
                            vendedor: document.getElementById('vendaVendedor').value,
                            premioLiquido: premioLiquido,
                            percentualComissao: percentualComissao,
                            comissaoTotal: comissaoTotal,
                            comissaoVendedor: comissaoVendedor
                        };
                        onlineSystem.showNotification('Venda atualizada!', 'success');
                    }
                    delete this.dataset.editingId;
                } else {
                    // Nova venda
                    const novaVenda = {
                        id: Date.now(),
                        cliente: document.getElementById('vendaCliente').value,
                        produto: document.getElementById('vendaProduto').value,
                        empresa: document.getElementById('vendaEmpresa').value,
                        vendedor: document.getElementById('vendaVendedor').value,
                        premioLiquido: premioLiquido,
                        percentualComissao: percentualComissao,
                        comissaoTotal: comissaoTotal,
                        comissaoVendedor: comissaoVendedor,
                        status: 'Fazer Vistoria',
                        data: new Date().toLocaleDateString('pt-BR')
                    };
                    
                    vendas.push(novaVenda);
                    
                    // Salvar imediatamente local e online
                    saveDataToStorage();
                    saveDataToGitHub().then(() => {
                        if (onlineSystem) {
                            onlineSystem.updateConnectionStatus('online');
                        }
                    }).catch(() => {
                        console.log('Salvamento online falhou para venda');
                    });
                    
                    // Notifica√ß√£o especial para admin
                    if (currentUser.tipo === 'admin') {
                        onlineSystem.showNotification(`üí∞ Venda "${novaVenda.cliente}" registrada para "${novaVenda.vendedor}" - R$ ${novaVenda.premioLiquido.toFixed(2)}`, 'success');
                        onlineSystem.showSyncNotification('Sincronizando online...', 'success');
                    } else {
                        onlineSystem.showNotification('Venda adicionada!', 'success');
                    }
                }
                
                updateKanbanVendas();
                updateVendasTable();
                updateDashboardStats();
                updateComissaoTable();
                
                this.reset();
                closeModal('novaVendaModal');
            });

            // Novo Vendedor form
            document.getElementById('novoVendedorForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const usuarioId = document.getElementById('vendedorUsuario').value;
                const usuario = usuarios.find(u => u.id == usuarioId);
                
                if (usuario) {
                    // Update existing user to be a vendor
                    usuario.nome = document.getElementById('vendedorNome').value;
                    usuario.meta = parseFloat(document.getElementById('vendedorMeta').value);
                    usuario.comissao = parseFloat(document.getElementById('vendedorComissao').value);
                    usuario.tipo = 'vendedor';
                    
                    updateVendedoresTable();
                    populateVendedorSelects();
                    populateUsuarioSelects();
                    
                    this.reset();
                    closeModal('novoVendedorModal');
                    onlineSystem.showNotification('Vendedor adicionado!', 'success');
                }
            });

            // Editar Vendedor form
            document.getElementById('editarVendedorForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const vendedorId = document.getElementById('editVendedorId').value;
                const vendedor = usuarios.find(u => u.id == vendedorId);
                
                if (vendedor) {
                    vendedor.nome = document.getElementById('editVendedorNome').value;
                    vendedor.meta = parseFloat(document.getElementById('editVendedorMeta').value);
                    vendedor.comissao = parseFloat(document.getElementById('editVendedorComissao').value);
                    
                    updateVendedoresTable();
                    populateVendedorSelects();
                    
                    this.reset();
                    closeModal('editarVendedorModal');
                    onlineSystem.showNotification('Vendedor atualizado!', 'success');
                }
            });
        }
        
        // Initialize system
        function initializeSystem() {
            populateVendedorSelects();
            populateUsuarioSelects();
            updateKanbanIndicacoes();
            updateKanbanVendas();
            updateIndicacoesTable();
            updateVendasTable();
            updateVendedoresTable();
            updateLeadSuhaiTable();
            updateComissaoTable();
            updateComissaoDetalhadaTable();
            updateCancelamentosTable();
            updateSemSucessoTable();
            updateDashboardStats();
            updateLeadSuhaiStats();
        }

        // Populate vendedor selects
        function populateVendedorSelects() {
            const vendedores = usuarios.filter(u => u.tipo === 'vendedor');
            const selects = ['indicacaoVendedor', 'vendaVendedor'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">Selecione um vendedor</option>';
                vendedores.forEach(vendedor => {
                    const option = document.createElement('option');
                    option.value = vendedor.nome;
                    option.textContent = vendedor.nome;
                    select.appendChild(option);
                });
            });

            // Restrict vendor selection for non-admin users
            if (currentUser && currentUser.tipo === 'vendedor') {
                const vendaVendedorSelect = document.getElementById('vendaVendedor');
                if (vendaVendedorSelect) {
                    vendaVendedorSelect.value = currentUser.nome;
                    vendaVendedorSelect.disabled = true;
                }
            }
        }

        // Populate usuario selects for vendor creation
        function populateUsuarioSelects() {
            const usuarios_disponiveis = usuarios.filter(u => u.tipo !== 'vendedor' || u.tipo === 'admin');
            const selects = ['vendedorUsuario', 'editVendedorUsuario'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">Selecione um usu√°rio</option>';
                    usuarios_disponiveis.forEach(usuario => {
                        const option = document.createElement('option');
                        option.value = usuario.id;
                        option.textContent = `${usuario.nome} (${usuario.login})`;
                        select.appendChild(option);
                    });
                }
            });
        }
        
        // Update functions
        function updateKanbanIndicacoes() {
            const containers = {
                'Lead Novo': document.getElementById('leadNovoContainer'),
                'WhatsApp': document.getElementById('whatsappContainer'),
                'Negociando': document.getElementById('negociandoContainer'),
                'Pedindo Dados': document.getElementById('pedindoDadosContainer')
            };
            
            // Limpar containers
            Object.values(containers).forEach(container => {
                if (container) container.innerHTML = '';
            });
            
            // Adicionar indica√ß√µes aos containers corretos
            indicacoes.forEach(indicacao => {
                const container = containers[indicacao.status];
                if (container) {
                    const item = document.createElement('div');
                    item.className = 'bg-gradient-to-br from-gray-700 to-gray-800 p-3 rounded-lg border border-gray-600';
                    item.innerHTML = `
                        <h4 class="text-white font-semibold text-sm mb-2">${indicacao.nome}</h4>
                        <p class="text-gray-300 text-xs mb-1"><i class="fas fa-phone mr-1 text-blue-400"></i>${indicacao.telefone}</p>
                        <p class="text-gray-300 text-xs mb-1"><i class="fas fa-car mr-1 text-yellow-400"></i>${indicacao.veiculo}</p>
                        <p class="text-gray-300 text-xs mb-2"><i class="fas fa-user mr-1 text-purple-400"></i>${indicacao.vendedor}</p>
                        ${indicacao.observacoes ? `<p class="text-gray-400 text-xs mb-2 italic"><i class="fas fa-comment mr-1 text-green-400"></i>${indicacao.observacoes}</p>` : ''}
                        
                        <!-- Action Buttons -->
                        <div class="flex justify-between gap-1 mb-2">
                            <button onclick="editarIndicacao(${indicacao.id})" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white text-xs px-2 py-1.5 rounded transition duration-200 flex items-center justify-center" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="confirmarDeleteIndicacaoKanban(${indicacao.id}, '${indicacao.nome}')" class="flex-1 bg-red-600 hover:bg-red-700 text-white text-xs px-2 py-1.5 rounded transition duration-200 flex items-center justify-center" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button onclick="proximoStatusIndicacao(${indicacao.id})" class="flex-1 bg-green-600 hover:bg-green-700 text-white text-xs px-2 py-1.5 rounded transition duration-200 flex items-center justify-center" title="Pr√≥ximo Status">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-2">
                            <button onclick="converterIndicacao('${indicacao.nome}', '${indicacao.vendedor}', '${indicacao.veiculo}', '${indicacao.telefone}')" 
                                    class="w-full bg-green-600 hover:bg-green-700 text-white text-xs px-2 py-2 rounded transition duration-200">
                                <i class="fas fa-check mr-1"></i>CONVERTER
                            </button>
                            <button onclick="semSucessoIndicacao('${indicacao.nome}', '${indicacao.vendedor}', '${indicacao.veiculo}', '${indicacao.telefone}')" 
                                    class="w-full bg-red-600 hover:bg-red-700 text-white text-xs px-2 py-2 rounded transition duration-200">
                                <i class="fas fa-times mr-1"></i>SEM SUCESSO
                            </button>
                        </div>
                    `;
                    container.appendChild(item);
                }
            });
        }
        
        function updateKanbanVendas() {
            const containers = {
                'Fazer Vistoria': document.getElementById('fazerVistoriaContainer'),
                'Mandar Boletos': document.getElementById('mandarBoletosContainer'),
                'Falta Pagamento': document.getElementById('faltaPagamentoContainer'),
                'Pagamento Efetuado': document.getElementById('pagamentoEfetuadoContainer')
            };
            
            // Limpar containers
            Object.values(containers).forEach(container => {
                if (container) container.innerHTML = '';
            });
            
            // Adicionar vendas aos containers corretos
            vendas.forEach(venda => {
                const container = containers[venda.status];
                if (container) {
                    // Verificar se j√° est√° no Lead Suhai
                    const jaNoSuhai = leadsSubai.some(lead => 
                        lead.cliente === venda.cliente && 
                        lead.vendedor === venda.vendedor && 
                        lead.produto === venda.produto
                    );
                    
                    const item = document.createElement('div');
                    item.className = 'bg-gradient-to-br from-gray-700 to-gray-800 p-3 rounded-lg border border-gray-600';
                    item.innerHTML = `
                        <h4 class="text-white font-semibold text-sm mb-2">${venda.cliente}</h4>
                        <p class="text-gray-300 text-xs mb-1"><i class="fas fa-shield-alt mr-1 text-blue-400"></i>${venda.produto}</p>
                        <p class="text-gray-300 text-xs mb-1"><i class="fas fa-user mr-1 text-purple-400"></i>${venda.vendedor}</p>
                        <p class="text-gray-300 text-xs mb-1"><i class="fas fa-building mr-1 text-green-400"></i>${venda.empresa}</p>
                        <p class="text-green-400 text-lg font-bold text-center mb-2">R$ ${venda.premioLiquido.toFixed(2)}</p>
                        
                        <!-- Lead Suhai Selection -->
                        <div class="mb-2">
                            <label class="flex items-center space-x-2 cursor-pointer bg-yellow-900 bg-opacity-30 p-2 rounded border border-yellow-600">
                                <input type="checkbox" class="lead-suhai-checkbox w-4 h-4 text-yellow-600 bg-gray-600 border-gray-500 rounded focus:ring-yellow-500" 
                                       ${jaNoSuhai ? 'checked' : ''}
                                       data-cliente="${venda.cliente}" 
                                       data-vendedor="${venda.vendedor}" 
                                       data-comissao="${venda.comissaoTotal.toFixed(2)}" 
                                       data-produto="${venda.produto}" 
                                       data-empresa="${venda.empresa}" 
                                       data-premio-liquido="${venda.premioLiquido}">
                                <span class="text-xs text-yellow-400 font-bold">LEAD SUHAI</span>
                            </label>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex justify-between gap-1 mb-2">
                            <button onclick="editarVenda(${venda.id})" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white text-xs px-2 py-1.5 rounded transition duration-200 flex items-center justify-center" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="confirmarDeleteVendaKanban(${venda.id}, '${venda.cliente}', ${venda.premioLiquido})" class="flex-1 bg-red-600 hover:bg-red-700 text-white text-xs px-2 py-1.5 rounded transition duration-200 flex items-center justify-center" title="Excluir">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        
                        <div class="flex gap-1">
                            <button onclick="proximoStatusVenda(${venda.id})" class="flex-1 bg-green-600 hover:bg-green-700 text-white text-xs px-1 py-1 rounded transition duration-200">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                            <button onclick="semSucessoVenda('${venda.cliente}', '${venda.vendedor}', '${venda.produto}', '${venda.empresa}', ${venda.id})" 
                                    class="flex-1 bg-red-600 hover:bg-red-700 text-white text-xs px-1 py-1 rounded transition duration-200">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    container.appendChild(item);
                }
            });
        }
        
        function updateIndicacoesTable() {
            const tbody = document.getElementById('indicacoesTableBody');
            tbody.innerHTML = '';
            
            indicacoes.forEach(indicacao => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${indicacao.nome}</td>
                    <td class="px-6 py-4 text-gray-300">${indicacao.telefone}</td>
                    <td class="px-6 py-4 text-gray-300">${indicacao.veiculo}</td>
                    <td class="px-6 py-4 text-gray-300">${indicacao.vendedor}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full bg-blue-600 text-white">${indicacao.status}</span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button onclick="editarIndicacao(${indicacao.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm transition duration-200 flex items-center" title="Editar indica√ß√£o">
                                <i class="fas fa-edit mr-1"></i>Editar
                            </button>
                            <button onclick="confirmarDeleteIndicacao(${indicacao.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded text-sm transition duration-200 flex items-center" title="Excluir indica√ß√£o">
                                <i class="fas fa-trash mr-1"></i>Excluir
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function updateVendasTable() {
            const tbody = document.getElementById('vendasTableBody');
            tbody.innerHTML = '';
            
            vendas.forEach(venda => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${venda.cliente}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.produto}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.empresa}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.vendedor}</td>
                    <td class="px-6 py-4 text-green-400 font-bold">R$ ${venda.premioLiquido.toFixed(2)}</td>
                    <td class="px-6 py-4 text-yellow-400 font-bold">${(venda.percentualComissao || 0).toFixed(2)}%</td>
                    <td class="px-6 py-4 text-blue-400 font-bold">R$ ${(venda.comissaoTotal || 0).toFixed(2)}</td>
                    <td class="px-6 py-4 text-purple-400 font-bold">R$ ${(venda.comissaoVendedor || 0).toFixed(2)}</td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button onclick="editarVenda(${venda.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm transition duration-200 flex items-center" title="Editar venda">
                                <i class="fas fa-edit mr-1"></i>Editar
                            </button>
                            <button onclick="confirmarDeleteVenda(${venda.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded text-sm transition duration-200 flex items-center" title="Excluir venda">
                                <i class="fas fa-trash mr-1"></i>Excluir
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function updateVendedoresTable() {
            const tbody = document.getElementById('vendedoresTableBody');
            tbody.innerHTML = '';
            
            usuarios.filter(u => u.tipo === 'vendedor').forEach(vendedor => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${vendedor.nome}</td>
                    <td class="px-6 py-4 text-gray-300">${vendedor.login}</td>
                    <td class="px-6 py-4 text-gray-300">R$ ${vendedor.meta.toLocaleString('pt-BR')}</td>
                    <td class="px-6 py-4 text-gray-300">${vendedor.comissao}%</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full bg-green-600 text-white">Ativo</span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button onclick="editarVendedor(${vendedor.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm transition duration-200 flex items-center" title="Editar vendedor">
                                <i class="fas fa-edit mr-1"></i>Editar
                            </button>
                            <button onclick="confirmarDeleteVendedor(${vendedor.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded text-sm transition duration-200 flex items-center" title="Excluir vendedor">
                                <i class="fas fa-trash mr-1"></i>Excluir
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateComissaoTable() {
            const tbody = document.getElementById('comissaoTableBody');
            if (!tbody) return; // Verificar se o elemento existe
            
            tbody.innerHTML = '';
            
            const vendedores = usuarios.filter(u => u.tipo === 'vendedor');
            
            vendedores.forEach(vendedor => {
                const vendasVendedor = vendas.filter(v => v.vendedor === vendedor.nome);
                const totalVendas = vendasVendedor.length;
                const premioTotal = vendasVendedor.reduce((sum, v) => sum + v.premioLiquido, 0);
                const comissaoTotal = vendasVendedor.reduce((sum, v) => sum + (v.comissaoVendedor || 0), 0);
                
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${vendedor.nome}</td>
                    <td class="px-6 py-4 text-gray-300">${totalVendas}</td>
                    <td class="px-6 py-4 text-green-400 font-bold">R$ ${premioTotal.toFixed(2)}</td>
                    <td class="px-6 py-4 text-blue-400 font-bold">R$ ${comissaoTotal.toFixed(2)}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${comissaoTotal > 0 ? 'bg-green-600' : 'bg-gray-600'} text-white">
                            ${comissaoTotal > 0 ? 'Pendente' : 'Sem vendas'}
                        </span>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateCancelamentosTable() {
            const tbody = document.getElementById('cancelamentosTableBody');
            tbody.innerHTML = '';
            
            cancelamentos.forEach(cancelamento => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${cancelamento.nome}</td>
                    <td class="px-6 py-4 text-gray-300">${cancelamento.empresa}</td>
                    <td class="px-6 py-4 text-gray-300">Cancelamento</td>
                    <td class="px-6 py-4 text-gray-300">Solicita√ß√£o do cliente</td>
                    <td class="px-6 py-4 text-gray-300">${cancelamento.data}</td>
                    <td class="px-6 py-4 text-red-400 font-bold">R$ ${cancelamento.valorEstorno.toFixed(2)}</td>
                `;
                tbody.appendChild(row);
            });
            
            if (cancelamentos.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="6" class="px-6 py-8 text-center text-gray-400">
                        <i class="fas fa-info-circle mr-2"></i>Nenhum cancelamento registrado
                    </td>
                `;
                tbody.appendChild(row);
            }
        }
        
        function updateComissaoDetalhadaTable() {
            const tbody = document.getElementById('comissaoDetalhadaTableBody');
            tbody.innerHTML = '';
            
            // Filtrar apenas vendas com status "Pagamento Efetuado"
            const vendasPagas = vendas.filter(v => v.status === 'Pagamento Efetuado');
            
            vendasPagas.forEach(venda => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${venda.cliente}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.vendedor}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.produto}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.empresa}</td>
                    <td class="px-6 py-4 text-green-400 font-bold">R$ ${venda.premioLiquido.toFixed(2)}</td>
                    <td class="px-6 py-4 text-blue-400 font-bold">R$ ${venda.comissaoVendedor.toFixed(2)}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.data}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full bg-green-600 text-white">Pago</span>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Atualizar totais
            const totalVendas = vendasPagas.length;
            const totalComissao = vendasPagas.reduce((sum, v) => sum + v.comissaoVendedor, 0);
            
            document.getElementById('totalVendasComissao').textContent = totalVendas;
            document.getElementById('totalComissaoGeral').textContent = `R$ ${totalComissao.toFixed(2)}`;
            
            if (vendasPagas.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="8" class="px-6 py-8 text-center text-gray-400">
                        <i class="fas fa-info-circle mr-2"></i>Nenhuma comiss√£o paga ainda
                    </td>
                `;
                tbody.appendChild(row);
            }
        }
        
        function updateLeadSuhaiStats() {
            const totalVendas = leadsSubai.length;
            const totalComissao = leadsSubai.reduce((sum, lead) => sum + parseFloat(lead.comissao), 0);
            
            document.getElementById('totalVendasSuhai').textContent = totalVendas;
            document.getElementById('totalComissaoSuhai').textContent = `R$ ${totalComissao.toFixed(2)}`;
            
            // Ranking de vendedores
            const vendedoresRanking = {};
            leadsSubai.forEach(lead => {
                if (!vendedoresRanking[lead.vendedor]) {
                    vendedoresRanking[lead.vendedor] = { vendas: 0, comissao: 0 };
                }
                vendedoresRanking[lead.vendedor].vendas++;
                vendedoresRanking[lead.vendedor].comissao += parseFloat(lead.comissao);
            });
            
            const ranking = Object.entries(vendedoresRanking)
                .sort((a, b) => b[1].vendas - a[1].vendas)
                .slice(0, 3);
            
            const rankingContainer = document.getElementById('rankingVendedoresSuhai');
            rankingContainer.innerHTML = '';
            
            if (ranking.length === 0) {
                rankingContainer.innerHTML = '<p class="text-gray-400 text-sm text-center">Nenhum dado dispon√≠vel</p>';
            } else {
                ranking.forEach((item, index) => {
                    const [vendedor, dados] = item;
                    const medalha = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : 'ü•â';
                    
                    const rankItem = document.createElement('div');
                    rankItem.className = 'flex items-center justify-between bg-gradient-to-r from-gray-700 to-gray-600 p-3 rounded-lg border border-gray-500 shadow-md hover:shadow-lg transition-all duration-300';
                    rankItem.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">${medalha}</span>
                            <span class="text-white text-sm font-bold">${vendedor}</span>
                        </div>
                        <div class="text-right">
                            <div class="text-yellow-400 text-sm font-bold">${dados.vendas} vendas</div>
                            <div class="text-green-400 text-xs font-medium">R$ ${dados.comissao.toFixed(2)}</div>
                        </div>
                    `;
                    rankingContainer.appendChild(rankItem);
                });
            }
        }

        function updateSemSucessoTable() {
            const tbody = document.getElementById('semSucessoTableBody');
            tbody.innerHTML = '';
            
            leadsSemSucesso.forEach(lead => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${lead.nome}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.telefone || 'N/A'}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.vendedor}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.motivo || 'N√£o informado'}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.data}</td>
                    <td class="px-6 py-4">
                        <button onclick="reverterSemSucesso(${lead.id})" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                            <i class="fas fa-undo mr-1"></i>Reverter
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Adicionar vendas sem sucesso tamb√©m
            vendasSemSucesso.forEach(venda => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${venda.cliente}</td>
                    <td class="px-6 py-4 text-gray-300">N/A</td>
                    <td class="px-6 py-4 text-gray-300">${venda.vendedor}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.motivo || 'Venda sem sucesso'}</td>
                    <td class="px-6 py-4 text-gray-300">${venda.data}</td>
                    <td class="px-6 py-4">
                        <button onclick="reverterVendaSemSucesso(${venda.id})" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                            <i class="fas fa-undo mr-1"></i>Reverter
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            if (leadsSemSucesso.length === 0 && vendasSemSucesso.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="6" class="px-6 py-8 text-center text-gray-400">
                        <i class="fas fa-info-circle mr-2"></i>Nenhum lead sem sucesso registrado
                    </td>
                `;
                tbody.appendChild(row);
            }
        }
        
        function updateLeadSuhaiTable() {
            const tbody = document.getElementById('leadSuhaiTableBody');
            tbody.innerHTML = '';
            
            leadsSubai.forEach(lead => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-700';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${lead.cliente}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.vendedor}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.produto}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.empresa}</td>
                    <td class="px-6 py-4 text-green-400 font-bold">R$ ${parseFloat(lead.premioLiquido).toFixed(2)}</td>
                    <td class="px-6 py-4 text-blue-400 font-bold">R$ ${parseFloat(lead.comissao).toFixed(2)}</td>
                    <td class="px-6 py-4 text-gray-300">${lead.dataEnvio}</td>
                `;
                tbody.appendChild(row);
            });

            if (leadsSubai.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="7" class="px-6 py-8 text-center text-gray-400">
                        <i class="fas fa-info-circle mr-2"></i>Nenhum lead enviado para Suhai
                    </td>
                `;
                tbody.appendChild(row);
            }
        }
        
        function updateDashboardStats() {
            const hoje = new Date().toLocaleDateString('pt-BR');
            
            // Leads do dia (indica√ß√µes criadas hoje)
            const leadsHoje = indicacoes.filter(i => i.data === hoje).length;
            document.getElementById('leadsDoDia').textContent = leadsHoje;
            
            // Vendas do dia
            const vendasHoje = vendas.filter(v => v.data === hoje).length;
            document.getElementById('vendasDoDia').textContent = vendasHoje;
            
            // Pr√™mio l√≠quido do dia
            const premioHoje = vendas
                .filter(v => v.data === hoje)
                .reduce((sum, v) => sum + v.premioLiquido, 0);
            document.getElementById('premioLiquidoDia').textContent = `R$ ${premioHoje.toFixed(2)}`;
            
            // Pr√™mio l√≠quido do m√™s
            const mesAtual = new Date().getMonth();
            const premioMes = vendas
                .filter(v => {
                    const dataVenda = v.data.split('/');
                    const mesVenda = parseInt(dataVenda[1]) - 1;
                    return mesVenda === mesAtual;
                })
                .reduce((sum, v) => sum + v.premioLiquido, 0);
            document.getElementById('premioLiquidoMes').textContent = `R$ ${premioMes.toFixed(2)}`;
        }
        
        // Navigation functions
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('bg-gray-700', 'text-white');
                item.classList.add('text-gray-300');
            });
            
            // Highlight active nav item
            event.target.classList.add('bg-gray-700', 'text-white');
            event.target.classList.remove('text-gray-300');
            
            // Close mobile menu
            if (window.innerWidth < 768) {
                toggleMobileMenu();
            }
        }
        
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.toggle('-translate-x-full');
            overlay.classList.toggle('hidden');
        }
        
        function logout() {
            currentUser = null;
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('crmSystem').classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }
        
        function forceSync() {
            if (onlineSystem) {
                onlineSystem.forceSync();
            }
        }
        
        async function forceSyncOnline() {
            if (onlineSystem) {
                onlineSystem.showNotification('Sincronizando com GitHub...', 'info');
                
                try {
                    // Salvar dados no GitHub
                    await saveDataToGitHub();
                    
                    // Carregar dados do GitHub
                    await loadDataFromGitHub();
                    
                    // Atualizar todas as interfaces
                    onlineSystem.updateAllInterfaces();
                    onlineSystem.updateConnectionStatus('online');
                    onlineSystem.showNotification('Sincroniza√ß√£o GitHub conclu√≠da!', 'success');
                } catch (error) {
                    onlineSystem.updateConnectionStatus('offline');
                    onlineSystem.showNotification('Erro na sincroniza√ß√£o GitHub. Verifique a configura√ß√£o.', 'warning');
                    console.error('Erro na sincroniza√ß√£o:', error);
                }
            }
        }
        
        // Modal functions
        function showNovaIndicacaoModal() {
            document.getElementById('novaIndicacaoModal').classList.remove('hidden');
        }
        
        function showNovaVendaModal() {
            document.getElementById('novaVendaModal').classList.remove('hidden');
        }
        
        function showNovoVendedorModal() {
            populateUsuarioSelects();
            document.getElementById('novoVendedorModal').classList.remove('hidden');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Fun√ß√µes do modal de confirma√ß√£o
        function showConfirmModal(title, message, onConfirm) {
            document.getElementById('confirmTitle').textContent = title;
            document.getElementById('confirmMessage').textContent = message;
            
            const confirmButton = document.getElementById('confirmButton');
            
            // Remover listeners anteriores
            const newButton = confirmButton.cloneNode(true);
            confirmButton.parentNode.replaceChild(newButton, confirmButton);
            
            // Adicionar novo listener
            newButton.addEventListener('click', function() {
                onConfirm();
                closeConfirmModal();
            });
            
            document.getElementById('confirmModal').classList.remove('hidden');
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.add('hidden');
        }
        
        // Placeholder functions for missing functionality
        function converterIndicacao(nome, vendedor, veiculo, telefone) {
            // Encontrar o vendedor para calcular comiss√£o
            const vendedorObj = usuarios.find(u => u.nome === vendedor);
            if (!vendedorObj) {
                onlineSystem.showNotification('Vendedor n√£o encontrado!', 'warning');
                return;
            }
            
            // Criar venda automaticamente
            const premioLiquido = 2000.00; // Valor padr√£o
            const comissaoVendedor = (premioLiquido * vendedorObj.comissao) / 100;
            
            const novaVenda = {
                id: Date.now(),
                cliente: nome,
                produto: 'Seguro Auto',
                empresa: 'Porto Seguro',
                vendedor: vendedor,
                premioLiquido: premioLiquido,
                comissaoVendedor: comissaoVendedor,
                comissaoTotal: comissaoVendedor,
                status: 'Fazer Vistoria',
                data: new Date().toLocaleDateString('pt-BR')
            };
            
            // Adicionar √† lista de vendas
            vendas.push(novaVenda);
            
            // Remover da lista de indica√ß√µes
            const indicacaoIndex = indicacoes.findIndex(i => i.nome === nome && i.vendedor === vendedor);
            if (indicacaoIndex !== -1) {
                indicacoes.splice(indicacaoIndex, 1);
            }
            
            // Atualizar todas as tabelas
            updateKanbanVendas();
            updateKanbanIndicacoes();
            updateVendasTable();
            updateIndicacoesTable();
            updateDashboardStats();
            updateComissaoTable();
            
            onlineSystem.showNotification(`${nome} convertido em venda com sucesso!`, 'success');
        }
        
        function semSucessoIndicacao(nome, vendedor, veiculo, telefone) {
            // Encontrar a indica√ß√£o pelo nome e vendedor
            const indicacaoIndex = indicacoes.findIndex(i => i.nome === nome && i.vendedor === vendedor);
            
            if (indicacaoIndex !== -1) {
                const indicacao = indicacoes[indicacaoIndex];
                
                const leadSemSucesso = {
                    id: Date.now(),
                    nome: nome,
                    telefone: telefone,
                    vendedor: vendedor,
                    veiculo: veiculo,
                    motivo: 'Cliente n√£o interessado',
                    data: new Date().toLocaleDateString('pt-BR'),
                    dadosOriginais: { ...indicacao }
                };
                
                // Remover do kanban de indica√ß√µes
                indicacoes.splice(indicacaoIndex, 1);
                
                // Adicionar √† lista sem sucesso
                leadsSemSucesso.push(leadSemSucesso);
                
                // Atualizar as tabelas
                updateKanbanIndicacoes();
                updateIndicacoesTable();
                updateSemSucessoTable();
                updateDashboardStats();
                
                onlineSystem.showNotification(`${nome} movido para Sem Sucesso`, 'warning');
            }
        }
        
        function editarIndicacao(id) {
            const indicacao = indicacoes.find(i => i.id === id);
            if (indicacao) {
                // Preencher modal com dados da indica√ß√£o
                document.getElementById('indicacaoNome').value = indicacao.nome;
                document.getElementById('indicacaoTelefone').value = indicacao.telefone;
                document.getElementById('indicacaoVeiculo').value = indicacao.veiculo;
                document.getElementById('indicacaoVendedor').value = indicacao.vendedor;
                document.getElementById('indicacaoObservacoes').value = indicacao.observacoes || '';
                
                // Marcar como edi√ß√£o
                document.getElementById('indicacaoForm').dataset.editingId = id;
                
                // Mostrar modal
                showNovaIndicacaoModal();
                
                onlineSystem.showNotification('Editando indica√ß√£o - fa√ßa as altera√ß√µes e salve', 'info');
            }
        }
        
        function confirmarDeleteIndicacao(id) {
            const indicacao = indicacoes.find(i => i.id === id);
            if (indicacao) {
                showConfirmModal(
                    'üóëÔ∏è CONFIRMAR EXCLUS√ÉO',
                    `Deseja realmente excluir a indica√ß√£o de:\n"${indicacao.nome}"?\n\nEsta a√ß√£o n√£o pode ser desfeita.`,
                    () => {
                        indicacoes = indicacoes.filter(i => i.id !== id);
                        updateKanbanIndicacoes();
                        updateIndicacoesTable();
                        updateDashboardStats();
                        onlineSystem.showNotification('Indica√ß√£o exclu√≠da com sucesso!', 'success');
                    }
                );
            }
        }

        function confirmarDeleteIndicacaoKanban(id, nome) {
            const indicacao = indicacoes.find(i => i.id === id);
            if (indicacao) {
                showConfirmModal(
                    'üóëÔ∏è CONFIRMAR EXCLUS√ÉO',
                    `Deseja realmente excluir a indica√ß√£o de:\n"${indicacao.nome}"?\n\nEsta a√ß√£o n√£o pode ser desfeita.`,
                    () => {
                        indicacoes = indicacoes.filter(i => i.id !== id);
                        updateKanbanIndicacoes();
                        updateIndicacoesTable();
                        updateDashboardStats();
                        onlineSystem.showNotification('Indica√ß√£o exclu√≠da com sucesso!', 'success');
                    }
                );
            }
        }
        
        function proximoStatusIndicacao(id) {
            const indicacao = indicacoes.find(i => i.id === id);
            if (indicacao) {
                const statusOrder = ['Lead Novo', 'WhatsApp', 'Negociando', 'Pedindo Dados'];
                const currentIndex = statusOrder.indexOf(indicacao.status);
                if (currentIndex < statusOrder.length - 1) {
                    indicacao.status = statusOrder[currentIndex + 1];
                    updateKanbanIndicacoes();
                    updateIndicacoesTable();
                    onlineSystem.showNotification(`${indicacao.nome} movido para ${indicacao.status}`, 'success');
                }
            }
        }
        
        function editarVenda(id) {
            const venda = vendas.find(v => v.id === id);
            if (venda) {
                // Preencher modal com dados da venda
                document.getElementById('vendaCliente').value = venda.cliente;
                document.getElementById('vendaProduto').value = venda.produto;
                document.getElementById('vendaEmpresa').value = venda.empresa;
                document.getElementById('vendaVendedor').value = venda.vendedor;
                document.getElementById('vendaPremio').value = venda.premioLiquido;
                document.getElementById('vendaPercentualComissao').value = venda.percentualComissao || 0;
                document.getElementById('vendaComissaoTotal').value = (venda.comissaoTotal || 0).toFixed(2);
                document.getElementById('vendaComissaoVendedor').value = (venda.comissaoVendedor || 0).toFixed(2);
                
                // Marcar como edi√ß√£o
                document.getElementById('vendaForm').dataset.editingId = id;
                
                // Mostrar modal
                showNovaVendaModal();
                
                onlineSystem.showNotification('Editando venda - fa√ßa as altera√ß√µes e salve', 'info');
            }
        }
        
        function confirmarDeleteVenda(id) {
            const venda = vendas.find(v => v.id === id);
            if (venda) {
                showConfirmModal(
                    'üóëÔ∏è CONFIRMAR EXCLUS√ÉO',
                    `Deseja realmente excluir a venda de:\n"${venda.cliente}"\nValor: R$ ${venda.premioLiquido.toFixed(2)}\n\nEsta a√ß√£o n√£o pode ser desfeita.`,
                    () => {
                        // Remover do Lead Suhai se estiver l√°
                        leadsSubai = leadsSubai.filter(lead => 
                            !(lead.cliente === venda.cliente && 
                              lead.vendedor === venda.vendedor && 
                              lead.produto === venda.produto)
                        );
                        
                        vendas = vendas.filter(v => v.id !== id);
                        updateKanbanVendas();
                        updateVendasTable();
                        updateDashboardStats();
                        updateComissaoTable();
                        updateComissaoDetalhadaTable();
                        updateLeadSuhaiTable();
                        updateLeadSuhaiStats();
                        onlineSystem.showNotification('Venda exclu√≠da com sucesso!', 'success');
                    }
                );
            }
        }

        function confirmarDeleteVendaKanban(id, cliente, valor) {
            const venda = vendas.find(v => v.id === id);
            if (venda) {
                showConfirmModal(
                    'üóëÔ∏è CONFIRMAR EXCLUS√ÉO',
                    `Deseja realmente excluir a venda de:\n"${venda.cliente}"\nValor: R$ ${venda.premioLiquido.toFixed(2)}\n\nEsta a√ß√£o n√£o pode ser desfeita.`,
                    () => {
                        // Remover do Lead Suhai se estiver l√°
                        leadsSubai = leadsSubai.filter(lead => 
                            !(lead.cliente === venda.cliente && 
                              lead.vendedor === venda.vendedor && 
                              lead.produto === venda.produto)
                        );
                        
                        vendas = vendas.filter(v => v.id !== id);
                        updateKanbanVendas();
                        updateVendasTable();
                        updateDashboardStats();
                        updateComissaoTable();
                        updateComissaoDetalhadaTable();
                        updateLeadSuhaiTable();
                        updateLeadSuhaiStats();
                        onlineSystem.showNotification('Venda exclu√≠da com sucesso!', 'success');
                    }
                );
            }
        }
        
        function proximoStatusVenda(id) {
            const venda = vendas.find(v => v.id === id);
            if (venda) {
                const statusOrder = ['Fazer Vistoria', 'Mandar Boletos', 'Falta Pagamento', 'Pagamento Efetuado'];
                const currentIndex = statusOrder.indexOf(venda.status);
                if (currentIndex < statusOrder.length - 1) {
                    venda.status = statusOrder[currentIndex + 1];
                    updateKanbanVendas();
                    updateVendasTable();
                    
                    // Se chegou em "Pagamento Efetuado", atualizar comiss√µes
                    if (venda.status === 'Pagamento Efetuado') {
                        updateComissaoDetalhadaTable();
                        onlineSystem.showNotification(`${venda.cliente} - Comiss√£o liberada!`, 'success');
                    } else {
                        onlineSystem.showNotification(`${venda.cliente} movido para ${venda.status}`, 'success');
                    }
                }
            }
        }
        
        function editarVendedor(id) {
            const vendedor = usuarios.find(u => u.id == id);
            if (vendedor) {
                // Preencher modal com dados do vendedor
                document.getElementById('editVendedorId').value = vendedor.id;
                document.getElementById('editVendedorNome').value = vendedor.nome;
                document.getElementById('editVendedorMeta').value = vendedor.meta || 0;
                document.getElementById('editVendedorComissao').value = vendedor.comissao || 0;
                
                // Populate and select current user
                populateUsuarioSelects();
                document.getElementById('editVendedorUsuario').value = vendedor.id;
                
                // Show modal
                document.getElementById('editarVendedorModal').classList.remove('hidden');
            }
        }
        
        function confirmarDeleteVendedor(id) {
            const vendedor = usuarios.find(u => u.id == id);
            if (vendedor) {
                showConfirmModal(
                    'üóëÔ∏è CONFIRMAR EXCLUS√ÉO',
                    `Deseja realmente excluir o vendedor:\n"${vendedor.nome}"\nLogin: ${vendedor.login}\n\nEsta a√ß√£o n√£o pode ser desfeita.`,
                    () => {
                        // Remover vendedor da lista
                        const index = usuarios.findIndex(u => u.id == id);
                        if (index !== -1) {
                            usuarios.splice(index, 1);
                            updateVendedoresTable();
                            populateVendedorSelects();
                            populateUsuarioSelects();
                            onlineSystem.showNotification(`Vendedor "${vendedor.nome}" exclu√≠do com sucesso!`, 'success');
                        }
                    }
                );
            }
        }
        
        // Nova fun√ß√£o para sem sucesso de vendas
        function semSucessoVenda(cliente, vendedor, produto, empresa, id) {
            const venda = vendas.find(v => v.id === id);
            if (venda) {
                const vendaSemSucesso = {
                    id: venda.id,
                    cliente: cliente,
                    vendedor: vendedor,
                    produto: produto,
                    empresa: empresa,
                    motivo: 'Venda sem sucesso',
                    data: new Date().toLocaleDateString('pt-BR'),
                    dadosOriginais: { ...venda }
                };
                
                vendasSemSucesso.push(vendaSemSucesso);
                vendas = vendas.filter(v => v.id !== id);
                
                updateKanbanVendas();
                updateVendasTable();
                updateSemSucessoTable();
                updateDashboardStats();
                updateComissaoDetalhadaTable();
                
                onlineSystem.showNotification(`${cliente} movido para Sem Sucesso`, 'warning');
            }
        }
        
        // Fun√ß√£o para reverter vendas sem sucesso
        function reverterVendaSemSucesso(id) {
            const vendaSemSucesso = vendasSemSucesso.find(v => v.id === id);
            if (vendaSemSucesso) {
                showConfirmModal(
                    'üîÑ CONFIRMAR REVERS√ÉO',
                    `Deseja reverter "${vendaSemSucesso.cliente}" para o Kanban de Vendas?\n\nA venda voltar√° para o status original.`,
                    () => {
                        // Restaurar venda original
                        vendas.push(vendaSemSucesso.dadosOriginais);
                        vendasSemSucesso = vendasSemSucesso.filter(v => v.id !== id);
                        
                        updateKanbanVendas();
                        updateVendasTable();
                        updateSemSucessoTable();
                        updateDashboardStats();
                        updateComissaoDetalhadaTable();
                        
                        onlineSystem.showNotification(`${vendaSemSucesso.cliente} revertido para Kanban de Vendas!`, 'success');
                    }
                );
            }
        }
        
        // Fun√ß√£o para reverter indica√ß√µes sem sucesso
        function reverterSemSucesso(id) {
            const leadSemSucesso = leadsSemSucesso.find(l => l.id === id);
            if (leadSemSucesso) {
                showConfirmModal(
                    'üîÑ CONFIRMAR REVERS√ÉO',
                    `Deseja reverter "${leadSemSucesso.nome}" para o Kanban de Indica√ß√µes?\n\nO lead voltar√° para o status "Lead Novo".`,
                    () => {
                        // Restaurar indica√ß√£o original se existir
                        if (leadSemSucesso.dadosOriginais) {
                            indicacoes.push(leadSemSucesso.dadosOriginais);
                        } else {
                            // Criar nova indica√ß√£o
                            const novaIndicacao = {
                                id: Date.now(),
                                nome: leadSemSucesso.nome,
                                telefone: leadSemSucesso.telefone || '',
                                veiculo: leadSemSucesso.veiculo || 'N√£o informado',
                                vendedor: leadSemSucesso.vendedor,
                                status: 'Lead Novo',
                                data: new Date().toLocaleDateString('pt-BR')
                            };
                            indicacoes.push(novaIndicacao);
                        }
                        
                        leadsSemSucesso = leadsSemSucesso.filter(l => l.id !== id);
                        
                        updateKanbanIndicacoes();
                        updateIndicacoesTable();
                        updateSemSucessoTable();
                        updateDashboardStats();
                        
                        onlineSystem.showNotification(`${leadSemSucesso.nome} revertido para Kanban de Indica√ß√µes!`, 'success');
                    }
                );
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'979fcc2dd711cada',t:'MTc1NzAxMzEzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
